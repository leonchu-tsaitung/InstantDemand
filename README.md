# 備貨決策系統 (InstantDemand)

## 📋 系統概述

**備貨決策系統**是蔬果產業需求管理工具，幫助管理者掌握庫存狀況、缺口需求，並規劃採購方式配置。

## ✨ 核心功能

### 🎯 篩選系統
- **採購方式篩選**：可單獨顯示「有包含」拍買、採買、直供指令的品項
- **蔬果類別篩選**
- **缺口狀態篩選**：可專注於今日有缺口的、未來有缺口的，即使尚無缺口的也可直接在此下決策
- **組合篩選**：以上篩選可混合使用

### 📊 四區塊資訊展示
每個品項以四區塊方式呈現：

#### 🏷️ 基本資訊區
- 品項名稱、現有庫存、在途庫存

#### ⚠️ 今日缺口區  
- 今日缺量、今日需求數據
- 拍買子項（可移動到未來區塊）
- 採買子項
- 可在拍買、採買、拍買+採買模式間切換

#### 🔮 未來缺口區
- 三日缺量
- 拍買子項
- 直供子項（列出每個供應商）

#### 📝 備註與儲存區
- **整合式備註輸入**：同一個輸入框既可從預設選項中選擇，也可直接手打
- **智能驗證**：當訂購量與建議值不同時，系統要求填寫備註說明
- **未儲存狀態指示**：有異動的品項會顯示視覺提醒（橙色邊框+脈動點）
- **儲存按鈕**：完成備註後可儲存異動，清除未儲存狀態

### 🔄 採購管理

#### 拍買項目管理
- **位置切換**：拍買項目可在今日/未來缺口區間移動，方便比較缺口數據
- **數量調整**：修改拍買數量
- **代碼追蹤**：拍賣代碼記錄

#### 採買項目管理  
- **攤商選擇**：從攤商清單選擇供應商
- **數量控制**：調整採購數量
- **價格顯示**：顯示採購價格

#### 直供項目管理
- **多供應商支援**：每個品項可有多個直供商
- **成本資訊**：
  - 報價更新時間
  - 供貨單位規格
  - 腐損率計算
  - 單位成本和含腐損成本
- **採購量管理**：各供應商採購量調整

### 🎛️ 操作介面

#### 模式轉換
- **切換**：拍買 ↔ 採買 ↔ 部分採買
- **預設**：根據缺量設定採購量
- **狀態管理**：Active/Inactive 品項狀態控制

#### 操作
- **確認機制**：操作前顯示確認對話框
- **狀態提醒**：有今日缺口品項設為 Inactive 時提醒

#### 資料匯出
- **拍買資訊複製**：匯出拍買品項資訊
- **採買資訊複製**：產生採買清單

### 📋 異動追蹤系統

#### 🎯 設計理念
- **非干擾式設計**：不使用彈窗打斷操作流程，改用視覺提示
- **使用者主導**：完全由使用者決定何時儲存，不強制中斷操作
- **智能提醒**：自動偵測與建議值的差異，適時要求說明

#### ⚡ 核心功能

##### 未儲存狀態管理
- **視覺標示**：修改數量或模式後，品項卡片會出現橙色左邊框
- **脈動提示**：品項名稱旁出現橙色脈動圓點，提醒有未儲存異動
- **狀態持續**：直到使用者點擊儲存按鈕才會清除提示

##### 整合式備註輸入
- **統一介面**：使用HTML5 datalist技術，一個輸入框搞定所有需求
- **預設選項**：提供5個常用異動原因（市場價格變動、供應商異動、庫存調整、需求預測修正、其他原因）
- **自由輸入**：可以直接手打任何說明文字
- **混合使用**：可以先選預設選項再修改，或完全自訂內容

##### 智能驗證機制
- **自動檢測**：比較當前訂購量與系統建議量
- **必填提醒**：有差異時要求填寫備註（選擇預設或手打皆可）
- **友善提示**：驗證失敗時顯示清楚的錯誤說明
- **彈性處理**：無差異時備註可選填

##### 資料持久化
- **本地儲存**：異動記錄保存在瀏覽器localStorage
- **完整記錄**：儲存時間戳記、建議vs實際值、備註內容等
- **跨會話保持**：關閉瀏覽器重新開啟後資料仍在

#### 🚀 使用流程

1. **修改數量/模式** → 品項自動標記為未儲存（橙色邊框+脈動點）
2. **填寫備註**（如有需要）→ 從預設選項中選擇或直接輸入說明
3. **點擊儲存** → 系統驗證通過後儲存並清除未儲存標記
4. **確認完成** → 品項顯示「已儲存」狀態，備註欄位清空

## 🔧 技術特色

### 前端技術
- **純前端實作**：HTML + CSS + Vanilla JavaScript，無需後端
- **Material Design**：使用Google Material Design Lite框架
- **響應式設計**：支援桌面、平板、手機等各種裝置

### 效能優化
- **客戶端篩選**：即時響應，無延遲
- **選擇性重渲染**：只更新必要的DOM元素
- **輕量級依賴**：最小化外部程式庫使用

### 相容性
- **跨瀏覽器**：支援現代瀏覽器
- **離線運行**：無需網路連接即可使用
- **無安裝需求**：開啟網頁即可使用

## 📱 執行方式

1. 直接開啟 `index.html` 檔案
2. 無需安裝或設定，立即可用
3. 支援離線使用
